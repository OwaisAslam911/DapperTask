@{
    ViewBag.Title = "Employee Filter";
}
<div class="content-body">
<h1>Employee Filter</h1>

<!-- Filter Form -->
<form id="filterForm">
    <div class="container" style="width:500px">
        <div>
        <label for="organizationSelect">Organization:</label>
                    <select class="form-control" id="OrganizationId" aria-label="Default select example" asp-items="ViewBag.Organizations">
                    <option selected>Select Organization</option>
                </select>
    </div>

    <div>
        <label for="departmentSelect">Department:</label>
                    <select class="form-control" id="DepartmentId" aria-label="Default select example" asp-items="ViewBag.Departments">
                    <option selected>Select Departments</option>
                </select>
    </div>

    <div>
        <label for="positionSelect">Position:</label>
                    <select class="form-control" id="PositionId" aria-label="Default select example" asp-items="ViewBag.Positions">
                    <option selected>Select Positions</option>
                </select>
            </div>

    <button type="button" class="btn btn-primary" id="filterButton">Filter</button>
    </div>
</form>

<!-- Table to display employees -->
<table id="employeeTable" class="table">
    <thead>
        <tr>
            <th>Organization</th>
            <th>Department</th>
            <th>Position</th>
            <th>Employee Name</th>
            <th>Salary</th>
        </tr>
    </thead>
    <tbody id="employeeTableBody">
        <!-- Filtered employee data will be populated here -->
    </tbody>
</table>
</div>

@section Scripts {
    <script>
        // When the organization changes, get the corresponding departments
  

        // Filter employees based on selected criteria
        $('#filterButton').click(function () {
            var organizationId = $('#organizationSelect').val();
            var departmentId = $('#departmentSelect').val();
            var positionId = $('#positionSelect').val();

            $.ajax({
                url: '@Url.Action("FilterEmployees", "Home")',
                type: 'GET',
            data: {
                    selectedOrganization: organizationId,
                    selectedDepartment: departmentId,
                    selectedPosition: positionId
                },
                success: function (data) {
                    var tableBody = $('#employeeTableBody');
                    tableBody.empty();  // Clear existing rows

                    if (data && data.length > 0) {
                        $.each(data, function (index, employee) {
                            tableBody.append(
                                '<tr>' +
                                '<td>' + employee.organizationName + '</td>' +
                                '<td>' + employee.departmentName + '</td>' +
                                '<td>' + employee.positionTitle + '</td>' +
                                '<td>' + employee.employeeName + '</td>' +
                                '<td>' + employee.salary + '</td>' +
                                '</tr>'
                            );
                        });

                    } else {
                        tableBody.append('<tr><td colspan="5">No employees found for the selected filter criteria.</td></tr>');
                    }
                }
            });
        });
    </script>
}
